{% include 'navbar.html' %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h3 class="mb-4">Edit New Product</h3>

    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Subcategory -->
       <div class="mb-3">
    <label for="subcategory" class="form-label">Subcategory</label>
    <select class="form-select" name="subcategory" id="subcategory" required>
        <option value="" disabled>Select a subcategory</option>
        {% for sub in subcategories %}
            <option value="{{ sub.id }}" {% if product.subcategory.id == sub.id %}selected{% endif %}>
                {{ sub.name }}
            </option>
        {% endfor %}
    </select>
</div>

        <!-- Name -->
        <div class="mb-3">
            <label for="name" class="form-label">Product Name</label>
            <input type="text" class="form-control" id="name" name="name" value="{{product.name}}" required>
        </div>

        <!-- Description -->
        <div class="mb-3">
            <label for="description" class="form-label">Description</label>
            <textarea class="form-control" id="description"  name="description" rows="3">{{product.description}}</textarea>
        </div>

        <!-- Price -->
        <div class="mb-3">
            <label for="price" class="form-label">Price (â‚¹)</label>
            <input type="number" step="0.01" class="form-control" id="price" value="{{product.price}}" name="price" required>
        </div>
<div class="mb-3">
    {% if product.image %}
     <img src="{{ product.image.url }}" width="80"><br>
    {% endif %}
    <label for="image" class="form-label">Main Product Image</label>
    <input type="file" class="form-control" id="image" name="image"  >
</div>
        <!-- Stock -->
        <div class="mb-3">
            <label for="stock" class="form-label">Stock</label>
            <input type="number" class="form-control" id="stock" name="stock" value="{{product.stock}}" required>
        </div>



       <div class="mb-3">
    <label class="form-label">Size</label><br>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="XS" id="sizeXS"
            {% if "XS" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeXS">Extra Small (XS)</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="S" id="sizeS"
            {% if "S" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeS">Small (S)</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="M" id="sizeM"
            {% if "M" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeM">Medium (M)</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="L" id="sizeL"
            {% if "L" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeL">Large (L)</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="XL" id="sizeXL"
            {% if "XL" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeXL">Extra Large (XL)</label>
    </div>

    <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="size" value="XXL" id="sizeXXL"
            {% if "XXL" in existing_sizes %}checked{% endif %}>
        <label class="form-check-label" for="sizeXXL">Double Extra Large (XXL)</label>
    </div>
</div>

      <div class="mb-3">
    <label class="form-label">Colors</label>
    <div id="colorContainer">
        {% if existing_colors %}
            {% for color in existing_colors %}
                <div class="d-flex mb-2 color-row">
                    <input type="text" name="color[]" value="{{ color }}" class="form-control me-2" placeholder="Enter Color (e.g., Red)">
                    <button type="button" class="btn btn-danger ms-2 remove-row">X</button>
                </div>
            {% endfor %}
        {% else %}
            <!-- Empty row if no colors exist -->
            <div class="d-flex mb-2 color-row">
                <input type="text" name="color[]" class="form-control me-2" placeholder="Enter Color (e.g., Red)">
                <button type="button" class="btn btn-danger ms-2 remove-row">X</button>
            </div>
        {% endif %}
    </div>
    <button type="button" id="addColor" class="btn btn-primary btn-sm mt-2">+ Add More Colors</button>
</div>


        <!-- Material -->
        <div class="mb-3">
            <label for="material" class="form-label">Material/Fabric</label>
            <input type="text" class="form-control" id="material" name="material" value="{{product.material}}" placeholder="e.g., Cotton, Silk">
        </div>



        <!-- Gender -->
        <div class="mb-3">
    <label for="gender" class="form-label">Ideal For</label>
    <select class="form-select" name="gender" id="gender">
        <option value="men" {% if product.gender == "men" %}selected{% endif %}>Men</option>
        <option value="women" {% if product.gender == "women" %}selected{% endif %}>Women</option>
        <option value="kids" {% if product.gender == "kids" %}selected{% endif %}>Kids</option>
    </select>
</div>

        <!-- Status -->
       <div class="mb-3">
    <label for="status" class="form-label">Status</label>
    <select class="form-select" name="status" id="status" required>
        <option value="active" {% if product.status == "active" %}selected{% endif %}>Active</option>
        <option value="inactive" {% if product.status == "inactive" %}selected{% endif %}>Inactive</option>
    </select>
</div>

        <!-- GST -->
        <div class="mb-3">
            <label for="gst_percentage" class="form-label">GST (%)</label>
            <input type="number" step="0.01" class="form-control" id="gst_percentage"  name="gst_percentage" value="{{product.gst_percentage}}">
        </div>

        <!-- Submit -->
        <button type="submit" class="btn btn-primary">Edit Product</button>
    </form>
</div>
{% endblock %}
<script>
document.getElementById("addColor").addEventListener("click", function () {
    let container = document.getElementById("colorContainer");
    let newRow = document.createElement("div");
    newRow.classList.add("d-flex", "mb-2", "color-row");
    newRow.innerHTML = `
        <input type="text" name="color[]" class="form-control me-2" placeholder="Enter Color (e.g., Blue)">
        <button type="button" class="btn btn-danger ms-2 remove-row">X</button>
    `;
    container.appendChild(newRow);
});
document.addEventListener("click", function (e) {
    if (e.target && e.target.classList.contains("remove-row")) {
        e.target.closest(".color-row").remove();
    }
});
</script>